var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function a(t){t.parentNode&&t.parentNode.removeChild(t)}function s(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function u(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function f(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let d;function p(t){d=t}function h(t){(function(){if(!d)throw new Error("Function called outside component initialization");return d})().$$.on_mount.push(t)}const g=[],m=[];let y=[];const v=[],b=Promise.resolve();let w=!1;function S(t){y.push(t)}const $=new Set;let x=0;function E(){if(0!==x)return;const t=d;do{try{for(;x<g.length;){const t=g[x];x++,p(t),P(t.$$)}}catch(t){throw g.length=0,x=0,t}for(p(null),g.length=0,x=0;m.length;)m.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];$.has(e)||($.add(e),e())}y.length=0}while(g.length);for(;v.length;)v.pop()();w=!1,$.clear(),p(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const T=new Set;function C(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];y.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),y=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _(t,e){-1===t.$$.dirty[0]&&(g.push(t),w||(w=!0,b.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(i,c,s,l,u,f,h,g=[-1]){const m=d;p(i);const y=i.$$={fragment:null,ctx:[],props:f,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(m?m.$$.context:[])),callbacks:n(),dirty:g,skip_bound:!1,root:c.target||m.$$.root};h&&h(y.root);let v=!1;if(y.ctx=s?s(i,c.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return y.ctx&&u(y.ctx[t],y.ctx[t]=o)&&(!y.skip_bound&&y.bound[t]&&y.bound[t](o),v&&_(i,t)),e})):[],y.update(),v=!0,o(y.before_update),y.fragment=!!l&&l(y.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);y.fragment&&y.fragment.l(t),t.forEach(a)}else y.fragment&&y.fragment.c();c.intro&&((b=i.$$.fragment)&&b.i&&(T.delete(b),b.i(w))),function(t,n,i,c){const{fragment:a,after_update:s}=t.$$;a&&a.m(n,i),c||S((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(S)}(i,c.target,c.anchor,c.customElement),E()}var b,w;p(m)}class k{$destroy(){C(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var R=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],O=function(t,e){var n=document.createElement("div");return function(e){var o,r=(o={position:"absolute",left:-9999,top:0,zIndex:-2e3},"TEXTAREA"===t.tagName&&R.push("width"),R.forEach((function(e){o[e]=getComputedStyle(t)[e]})),o);Object.keys(r).forEach((function(t){n.style[t]=r[t]})),n.innerHTML=e,t.parentNode.insertBefore(n,t.nextSibling)}(e),{rect:function(){var t=n.ownerDocument.getElementById("caret-position-marker"),e={left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight};return n.parentNode.removeChild(n),e}}};function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}var L=function(t,e){var n=function(){return t.selectionStart},o=function(o){var r=function(t){return t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>")};(e.customPos||0===e.customPos)&&(o=e.customPos);var i=void 0===o?n():o,c=t.value.slice(0,i),a=t.value.slice(i),s='<span style="position: relative; display: inline;">'.concat(r(c),"</span>");s+='<span id="caret-position-marker" style="position: relative; display: inline;">|</span>',s+='<span style="position: relative; display: inline;">'.concat(r(a),"</span>");var l=O(t,s).rect();return l.pos=n(),l};return{getPos:n,setPos:function(e){return t.setSelectionRange(e,e),t},getOffset:function(n){var r=function(t,e){var n=e&&e.window||window,o=e&&e.document||document,r=t.getBoundingClientRect(),i=o.documentElement,c=n.pageXOffset||i.scrollLeft,a=n.pageYOffset||i.scrollTop;return{top:r.top+a,left:r.left+c}}(t),i=o(n);return{top:r.top+i.top+e.document.body.scrollTop,left:r.left+i.left+e.document.body.scrollLeft,height:i.height}},getPosition:o}},B=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(t){return"object"===A(t)&&null!==t})(e)&&(n=e,e=null);var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.customPos,n=t.iframe,o=t.noShadowCaret;return n?{iframe:n,window:n.contentWindow,document:n.contentDocument||n.contentWindow.document,noShadowCaret:o,customPos:e}:{window:window,document:document,noShadowCaret:o,customPos:e}}(n),r=function(t,e){return function(t){return!!(t.contentEditable?"true"===t.contentEditable:"true"===t.getAttribute("contenteditable"))}(t)?function(t,e){var n=function(){var n=o(),r={height:0,left:0,right:0};if(!n)return r;var i=e.customPos||0===e.customPos;if(n.endOffset-1>0&&n.endContainer!==t||i){var c=n.cloneRange(),a=i?e.customPos:n.endOffset;c.setStart(n.endContainer,a-1<0?0:a-1),c.setEnd(n.endContainer,a);var s=c.getBoundingClientRect();r={height:s.height,left:s.left+s.width,top:s.top},c.detach()}if((!r||r&&0===r.height)&&!e.noShadowCaret){var l=n.cloneRange(),u=e.document.createTextNode("|");l.insertNode(u),l.selectNode(u);var f=l.getBoundingClientRect();r={height:f.height,left:f.left,top:f.top},u.parentNode.removeChild(u),l.detach()}if(r){var d=e.document.documentElement;r.top+=e.window.pageYOffset-(d.clientTop||0),r.left+=e.window.pageXOffset-(d.clientLeft||0)}return r},o=function(){if(e.window.getSelection){var t=e.window.getSelection();return t.rangeCount>0?t.getRangeAt(0):null}},r=function(){var e=o(),n=e.cloneRange();n.selectNodeContents(t),n.setEnd(e.endContainer,e.endOffset);var r=n.toString().length;return n.detach(),r};return{getPos:r,setPos:function(n){var o=e.window.getSelection();if(o){var r=0,i=!1;!function t(c,a){for(var s=0;s<a.childNodes.length;s++){var l=a.childNodes[s];if(i)break;if(3===l.nodeType){if(r+l.length>=c){i=!0;var u=e.document.createRange();u.setStart(l,c-r),o.removeAllRanges(),o.addRange(u);break}r+=l.length}else t(n,l)}}(n,t)}return t},getPosition:function(){var o=n(),i=r(),c=t.getBoundingClientRect(),a=c.top+e.document.body.scrollTop,s=c.left+e.document.body.scrollLeft;return o.left-=s,o.top-=a,o.pos=i,o},getOffset:n,getRange:o}}(t,e):L(t,e)}(t,o);return r.getOffset(e)};function I(e){let n,r,i,d,p,h,g,m,y,v;return{c(){var t,e,o,c;n=s("main"),r=s("div"),i=s("button"),i.textContent="Play",d=l("\n    x"),p=s("input"),h=l(" "),g=s("div"),m=s("textarea"),f(i,"class","play"),f(p,"type","text"),t=p,e="width",null==(o="32px")?t.style.removeProperty(e):t.style.setProperty(e,o,c?"important":""),p.value=j,f(m,"placeholder","再生するテキスト"),f(m,"class","svelte-1hp6xvt"),f(g,"class","container svelte-1hp6xvt")},m(t,o){!function(t,e,n){t.insertBefore(e,n||null)}(t,n,o),c(n,r),c(r,i),e[6](i),c(r,d),c(r,p),e[7](p),c(n,h),c(n,g),c(g,m),e[8](m),y||(v=[u(i,"click",e[3]),u(p,"change",e[5]),u(m,"input",e[4])],y=!0)},p:t,i:t,o:t,d(t){t&&a(n),e[6](null),e[7](null),e[8](null),y=!1,o(v)}}}const W="SPEECH/TEXT",H="SPEECH/SPEED",j=2;function X(t,e,n){let o=null,r=null,i=null,c=null;window.OnActive=async()=>{r.focus()},h((async()=>{n(1,r.value=localStorage.getItem(W),r),speechSynthesis.cancel(),n(0,o.innerText="Play",o),document.onkeypress=t=>{t?.ctrlKey&&"KeyS"==t?.code&&s()},requestAnimationFrame(a)}));const a=()=>{const t=speechSynthesis.getVoices();if(t){c=t.filter((t=>t.name.startsWith("Microsoft Haruka")))[0];const e=localStorage.getItem(H);0==isNaN(parseInt(e))?n(2,i.value=e,i):n(2,i.value=c?4:j,i)}else requestAnimationFrame(a)},s=()=>{if(speechSynthesis.speaking)speechSynthesis.cancel(),n(0,o.innerText="Play",o);else{const t=new SpeechSynthesisUtterance;let e=r.value;e=e.replace(/[ -/:-@\[-\`\{-\~]/g," "),e=e.replace(/(　|。|、|：|（|）|⇒|？|・|，|＃|＞|＜|＿|”|’|｜|‘|！|…|～)/g," "),e=e.replace(/[\r|\n]/g," "),t.text=e;const a=parseInt(i.value);t.rate=isNaN(a)?1:a,t.lang="ja-JP",c&&(t.voice=c),t.onstart=()=>n(0,o.innerText="Stop",o),t.onboundary=t=>{"word"==t.name&&(r.focus(),r.setSelectionRange(t.charIndex,t.charIndex+t.charLength),n(1,r.scrollTop=B(r).top-r.offsetHeight/2,r))},t.onend=()=>{n(0,o.innerText="Play",o)},speechSynthesis.speak(t)}};return[o,r,i,s,()=>{localStorage.setItem(W,r.value)},()=>{const t=parseInt(i.value);0==isNaN(t)&&localStorage.setItem(H,i.value)},function(t){m[t?"unshift":"push"]((()=>{o=t,n(0,o)}))},function(t){m[t?"unshift":"push"]((()=>{i=t,n(2,i)}))},function(t){m[t?"unshift":"push"]((()=>{r=t,n(1,r)}))}]}return new class extends k{constructor(t){super(),N(this,t,X,I,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
