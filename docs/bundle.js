var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a=!1;const c=new Set;function l(t,e){a&&c.delete(e),e.parentNode!==t&&t.appendChild(e)}function s(t){a?c.add(t):t.parentNode&&t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let g;function h(t){g=t}function m(t){(function(){if(!g)throw new Error("Function called outside component initialization");return g})().$$.on_mount.push(t)}const v=[],y=[],b=[],w=[],S=Promise.resolve();let x=!1;function $(t){b.push(t)}let E=!1;const T=new Set;function C(){if(!E){E=!0;do{for(let t=0;t<v.length;t+=1){const e=v[t];h(e),N(e.$$)}for(h(null),v.length=0;y.length;)y.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];T.has(e)||(T.add(e),e())}b.length=0}while(v.length);for(;w.length;)w.pop()();x=!1,E=!1,T.clear()}}function N(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($)}}const P=new Set;function _(t,e){-1===t.$$.dirty[0]&&(v.push(t),x||(x=!0,S.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function k(i,l,u,f,d,p,m=[-1]){const v=g;h(i);const y=i.$$={fragment:null,ctx:null,props:p,update:t,not_equal:d,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(v?v.$$.context:l.context||[]),callbacks:n(),dirty:m,skip_bound:!1};let b=!1;if(y.ctx=u?u(i,l.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return y.ctx&&d(y.ctx[t],y.ctx[t]=o)&&(!y.skip_bound&&y.bound[t]&&y.bound[t](o),b&&_(i,t)),e})):[],y.update(),b=!0,o(y.before_update),y.fragment=!!f&&f(y.ctx),l.target){if(l.hydrate){a=!0;const t=function(t){return Array.from(t.childNodes)}(l.target);y.fragment&&y.fragment.l(t),t.forEach(s)}else y.fragment&&y.fragment.c();l.intro&&((w=i.$$.fragment)&&w.i&&(P.delete(w),w.i(S))),function(t,n,i,a){const{fragment:c,on_mount:l,on_destroy:s,after_update:u}=t.$$;c&&c.m(n,i),a||$((()=>{const n=l.map(e).filter(r);s?s.push(...n):o(n),t.$$.on_mount=[]})),u.forEach($)}(i,l.target,l.anchor,l.customElement),function(){a=!1;for(const t of c)t.parentNode.removeChild(t);c.clear()}(),C()}var w,S;h(v)}var R=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],O=function(t,e){var n=document.createElement("div");return function(e){var o,r=(o={position:"absolute",left:-9999,top:0,zIndex:-2e3},"TEXTAREA"===t.tagName&&R.push("width"),R.forEach((function(e){o[e]=getComputedStyle(t)[e]})),o);Object.keys(r).forEach((function(t){n.style[t]=r[t]})),n.innerHTML=e,t.parentNode.insertBefore(n,t.nextSibling)}(e),{rect:function(){var t=n.ownerDocument.getElementById("caret-position-marker"),e={left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight};return n.parentNode.removeChild(n),e}}};function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.customPos,n=t.iframe,o=t.noShadowCaret;return n?{iframe:n,window:n.contentWindow,document:n.contentDocument||n.contentWindow.document,noShadowCaret:o,customPos:e}:{window:window,document:document,noShadowCaret:o,customPos:e}},B=function(t){return"object"===L(t)&&null!==t},I=function(t,e){var n=function(){return t.selectionStart},o=function(o){var r=function(t){return t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>")};(e.customPos||0===e.customPos)&&(o=e.customPos);var i=void 0===o?n():o,a=t.value.slice(0,i),c=t.value.slice(i),l='<span style="position: relative; display: inline;">'.concat(r(a),"</span>");l+='<span id="caret-position-marker" style="position: relative; display: inline;">|</span>',l+='<span style="position: relative; display: inline;">'.concat(r(c),"</span>");var s=O(t,l).rect();return s.pos=n(),s};return{getPos:n,setPos:function(e){return t.setSelectionRange(e,e),t},getOffset:function(n){var r=function(t,e){var n=e&&e.window||window,o=e&&e.document||document,r=t.getBoundingClientRect(),i=o.documentElement,a=n.pageXOffset||i.scrollLeft,c=n.pageYOffset||i.scrollTop;return{top:r.top+c,left:r.left+a}}(t),i=o(n);return{top:r.top+i.top+e.document.body.scrollTop,left:r.left+i.left+e.document.body.scrollLeft,height:i.height}},getPosition:o}},W=function(t,e){return function(t){return!!(t.contentEditable?"true"===t.contentEditable:"true"===t.getAttribute("contenteditable"))}(t)?function(t,e){var n=function(){var n=o(),r={height:0,left:0,right:0};if(!n)return r;var i=e.customPos||0===e.customPos;if(n.endOffset-1>0&&n.endContainer!==t||i){var a=n.cloneRange(),c=i?e.customPos:n.endOffset;a.setStart(n.endContainer,c-1<0?0:c-1),a.setEnd(n.endContainer,c);var l=a.getBoundingClientRect();r={height:l.height,left:l.left+l.width,top:l.top},a.detach()}if((!r||r&&0===r.height)&&!e.noShadowCaret){var s=n.cloneRange(),u=e.document.createTextNode("|");s.insertNode(u),s.selectNode(u);var f=s.getBoundingClientRect();r={height:f.height,left:f.left,top:f.top},u.parentNode.removeChild(u),s.detach()}if(r){var d=e.document.documentElement;r.top+=e.window.pageYOffset-(d.clientTop||0),r.left+=e.window.pageXOffset-(d.clientLeft||0)}return r},o=function(){if(e.window.getSelection){var t=e.window.getSelection();return t.rangeCount>0?t.getRangeAt(0):null}},r=function(){var e=o(),n=e.cloneRange();n.selectNodeContents(t),n.setEnd(e.endContainer,e.endOffset);var r=n.toString().length;return n.detach(),r};return{getPos:r,setPos:function(n){var o=e.window.getSelection();if(o){var r=0,i=!1;!function t(a,c){for(var l=0;l<c.childNodes.length;l++){var s=c.childNodes[l];if(i)break;if(3===s.nodeType){if(r+s.length>=a){i=!0;var u=e.document.createRange();u.setStart(s,a-r),o.removeAllRanges(),o.addRange(u);break}r+=s.length}else t(n,s)}}(n,t)}return t},getPosition:function(){var o=n(),i=r(),a=t.getBoundingClientRect(),c=a.top+e.document.body.scrollTop,l=a.left+e.document.body.scrollLeft;return o.left-=l,o.top-=c,o.pos=i,o},getOffset:n,getRange:o}}(t,e):I(t,e)};function H(e){let n,r,i,g,h,m,v,y,b,w;return{c(){var t,e,o;n=u("main"),r=u("div"),i=u("button"),i.textContent="▶",g=f("\n    x"),h=u("input"),m=f(" "),v=u("div"),y=u("textarea"),p(i,"class","play"),p(h,"type","text"),t="width",e="32px",h.style.setProperty(t,e,o?"important":""),h.value=z,p(y,"placeholder","再生するテキスト"),p(y,"class","svelte-1hp6xvt"),p(v,"class","container svelte-1hp6xvt")},m(t,o){!function(t,e,n){a&&c.delete(e),(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}(t,n,o),l(n,r),l(r,i),e[6](i),l(r,g),l(r,h),e[7](h),l(n,m),l(n,v),l(v,y),e[8](y),b||(w=[d(i,"click",e[3]),d(h,"change",e[5]),d(y,"input",e[4])],b=!0)},p:t,i:t,o:t,d(t){t&&s(n),e[6](null),e[7](null),e[8](null),b=!1,o(w)}}}const j="SPEECH/TEXT",X="SPEECH/SPEED",z=2;function F(t,e,n){let o=null,r=null,i=null,a=null;window.OnActive=async()=>{r.focus();const t=await navigator.clipboard.readText();t?.length>0&&(n(1,r.value=t,r),await navigator.clipboard.writeText(""))},m((async()=>{n(1,r.value=localStorage.getItem(j),r),speechSynthesis.cancel(),n(0,o.innerText="⏵",o),document.onkeypress=t=>{t?.ctrlKey&&"KeyS"==t?.code&&l()},requestAnimationFrame(c)}));const c=()=>{const t=speechSynthesis.getVoices();if(console.log(t.map((t=>t.name))),t){a=t.filter((t=>t.name.startsWith("Microsoft Haruka")))[0];const e=localStorage.getItem(X);0==isNaN(parseInt(e))?n(2,i.value=e,i):n(2,i.value=a?4:z,i)}else requestAnimationFrame(c)},l=()=>{if(speechSynthesis.speaking)speechSynthesis.cancel(),n(0,o.innerText="⏵",o);else{const t=new SpeechSynthesisUtterance;let e=r.value;e=e.replace(/[ -/:-@\[-\`\{-\~]/g," "),e=e.replace(/(　|。|、|：|（|）|⇒|？|・|，|＃|＞|＜|＿|\”|’|｜|‘|！|…|～)/g," "),e=e.replace(/[\r|\n]/g," "),t.text=e;const c=parseInt(i.value);t.rate=isNaN(c)?1:c,t.lang="ja-JP",a&&(t.voice=a),t.onstart=()=>n(0,o.innerText="■",o),t.onboundary=t=>{"word"==t.name&&(r.focus(),r.setSelectionRange(t.charIndex+t.charLength,t.charIndex+t.charLength),n(1,r.scrollTop=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};B(e)&&(n=e,e=null);var o=A(n);return W(t,o).getOffset(e)}(r).top-r.offsetHeight/2,r))},t.onend=()=>{n(0,o.innerText="⏵",o)},speechSynthesis.speak(t)}};return[o,r,i,l,()=>{localStorage.setItem(j,r.value)},()=>{const t=parseInt(i.value);0==isNaN(t)&&localStorage.setItem(X,i.value)},function(t){y[t?"unshift":"push"]((()=>{o=t,n(0,o)}))},function(t){y[t?"unshift":"push"]((()=>{i=t,n(2,i)}))},function(t){y[t?"unshift":"push"]((()=>{r=t,n(1,r)}))}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),k(this,t,F,H,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
